# 笔记

## 2 方法

- 扰动是会影响结果的，扰动包括定时执行的系统活动，系统的其他用户以及其他的工作负载。
- 在CPU接近100%使用率时，在增加线程，会导致更多得上下文切换，消耗CPU资源，降低性能。

## 2.3.11 使用率

- 使用率（非空闲时间）用于操作系统描述设备的使用情况。
- 使用率是基于时间的或者是基于容量的。
- U(使用率) = B(T时间内系统的繁忙时间)/T(观测周期)。
- 100%的使用率只是指时间上100%的忙碌，并不意味着100%容量的使用，参考电梯例子。

## 2.3.14 缓存

- 缓存是将较慢的存储层的结果存放在较快的存储层中。
- 98%和99%的性能差异要比10%和11%的性能差异大很多，非线性曲线。
- 了解缓存性能的指标：命中率，失效率。
- 当缓存初始化后，开始是冷的，过一段时间后逐渐变暖。

## 2.4 视角

- 性能分析视角：资源分析，工作负载分析。

## 2.5 性能分析方法

- USE方法：对于所有的资源，查看它的使用率，饱和度和错误。
  - 资源：所有物理元器件，某些软件资源。
  - 使用率：规定时间内，资源用于服务工作的时间百分比。虽然资源繁忙，但是资源还有能力接受更多的工作，不能接受更多工作的程度被视为饱和度。
  - 饱和度：资源不能在服务更多额外工作的程度，通常有等待队列。
  - 错误：错误事件的个数。

## 2.6 建模

- 常见性能扩展曲线：
  - 线性：性能随着资源的扩展成比例的增加。
  - 竞争：架构的某些组件是共享的，而且只能串行使用，对这些资源的竞争会减少扩展的效益。
  - 一致性：由于要维持数据的一致性，传播数据变化的代价会超过扩展带来的好处。
  - 拐点：某个因素碰到了扩展的制约点。
  - 扩展上限：到达了一个硬件的极限。

## 2.8.2 平均值

- 几何平均值：数值乘积的N次方根，N为数值的个数。
- 调和平均值：数值的个数除以所有数值的倒数之和。
- 标准方差：度量数据的离散程度，越大表示数据偏离均值的程度越大。
- 每当看到性能指标的平均值时，尤其是平均延时，要清楚分布（有人在渡平均深度10cm的河流时淹死）。
- 对于正态分布，异常值的存在可能会让平均值偏移，但对中位数没什么影响。
